/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, QueryList } from "@angular/core";
import { DynamicFormArrayGroupModel } from "../model/form-array/dynamic-form-array.model";
import { DYNAMIC_TEMPLATE_DIRECTIVE_ALIGNMENT } from "../directive/dynamic-template.directive";
import { isObject } from "../utils/core.utils";
import * as i0 from "@angular/core";
export class DynamicFormLayoutService {
    /**
     * @param {?} id
     * @param {?} formLayout
     * @return {?}
     */
    findById(id, formLayout) {
        if (isObject(formLayout)) {
            for (let key of Object.keys(formLayout)) {
                if (key === id) {
                    return formLayout[key];
                }
            }
        }
        return null;
    }
    /**
     * @param {?} model
     * @param {?} formLayout
     * @return {?}
     */
    findByModel(model, formLayout) {
        /** @type {?} */
        let controlLayout = null;
        if (isObject(formLayout)) {
            for (let key of Object.keys(formLayout)) {
                key.split(",").forEach((/**
                 * @param {?} substring
                 * @return {?}
                 */
                substring => {
                    /** @type {?} */
                    const selector = substring.trim();
                    if (selector === model.id || selector === model.type) {
                        controlLayout = formLayout[key];
                    }
                }));
            }
        }
        return controlLayout;
    }
    /**
     * @param {?} model
     * @param {?} templates
     * @return {?}
     */
    filterTemplatesByModel(model, templates) {
        /** @type {?} */
        const filterCallback = (/**
         * @param {?} template
         * @return {?}
         */
        (template) => {
            return template.modelId === model.id || template.modelType === model.type;
        });
        if (templates instanceof QueryList) {
            return templates.filter(filterCallback);
        }
        else if (Array.isArray(templates)) {
            return templates.filter(filterCallback);
        }
        return [];
    }
    /**
     * @param {?} model
     * @param {?} templates
     * @param {?} alignment
     * @return {?}
     */
    getAlignedTemplate(model, templates, alignment) {
        return this.filterTemplatesByModel(model, templates)
            .find((/**
         * @param {?} template
         * @return {?}
         */
        template => template.as === null && template.align === alignment));
    }
    /*
        getIndexedTemplates(model: DynamicFormControlModel, templates: DynamicFormControlTemplates): DynamicTemplateDirective[] | undefined {
            return this.filterTemplatesByModel(model, templates).filter(template => template.as === null);
        }
        */
    /**
     * @param {?} model
     * @param {?} templates
     * @return {?}
     */
    getStartTemplate(model, templates) {
        return this.getAlignedTemplate(model, templates, DYNAMIC_TEMPLATE_DIRECTIVE_ALIGNMENT.Start);
    }
    /**
     * @param {?} model
     * @param {?} templates
     * @return {?}
     */
    getEndTemplate(model, templates) {
        return this.getAlignedTemplate(model, templates, DYNAMIC_TEMPLATE_DIRECTIVE_ALIGNMENT.End);
    }
    /**
     * @param {?} layout
     * @param {?} context
     * @param {?} place
     * @return {?}
     */
    getClass(layout, context, place) {
        if (layout !== null && layout.hasOwnProperty(context)) {
            /** @type {?} */
            let config = (/** @type {?} */ (layout[context]));
            if (config.hasOwnProperty(place)) {
                return (/** @type {?} */ (config[place]));
            }
        }
        return "";
    }
    /**
     * @param {?} model
     * @return {?}
     */
    getElementId(model) {
        /** @type {?} */
        let id = model.id;
        /** @type {?} */
        let parent = model.parent;
        while (parent !== null) {
            if (parent instanceof DynamicFormArrayGroupModel) {
                id = `${parent.context.id}-${parent.index}-${model.id}`;
                break;
            }
            parent = parent.parent;
        }
        return id;
    }
}
DynamicFormLayoutService.decorators = [
    { type: Injectable, args: [{
                providedIn: "root"
            },] }
];
/** @nocollapse */ DynamicFormLayoutService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function DynamicFormLayoutService_Factory() { return new DynamicFormLayoutService(); }, token: DynamicFormLayoutService, providedIn: "root" });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy1mb3JtLWxheW91dC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQG5nLWR5bmFtaWMtZm9ybXMvY29yZS8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlL2R5bmFtaWMtZm9ybS1sYXlvdXQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFRdEQsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sOENBQThDLENBQUM7QUFDMUYsT0FBTyxFQUVILG9DQUFvQyxFQUN2QyxNQUFNLHlDQUF5QyxDQUFDO0FBQ2pELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7QUFTL0MsTUFBTSxPQUFPLHdCQUF3Qjs7Ozs7O0lBRWpDLFFBQVEsQ0FBQyxFQUFVLEVBQUUsVUFBb0M7UUFFckQsSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFFdEIsS0FBSyxJQUFJLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUVyQyxJQUFJLEdBQUcsS0FBSyxFQUFFLEVBQUU7b0JBQ1osT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7aUJBQzFCO2FBQ0o7U0FDSjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Ozs7OztJQUVELFdBQVcsQ0FBQyxLQUE4QixFQUFFLFVBQW9DOztZQUV4RSxhQUFhLEdBQTZCLElBQUk7UUFFbEQsSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFFdEIsS0FBSyxJQUFJLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUVyQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU87Ozs7Z0JBQUMsU0FBUyxDQUFDLEVBQUU7OzBCQUV6QixRQUFRLEdBQUcsU0FBUyxDQUFDLElBQUks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fSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHtcbiAgICBEeW5hbWljRm9ybUNvbnRyb2xMYXlvdXQsXG4gICAgRHluYW1pY0Zvcm1Db250cm9sTGF5b3V0Q29uZmlnLFxuICAgIER5bmFtaWNGb3JtQ29udHJvbExheW91dENvbnRleHQsXG4gICAgRHluYW1pY0Zvcm1Db250cm9sTGF5b3V0UGxhY2Vcbn0gZnJvbSBcIi4uL21vZGVsL21pc2MvZHluYW1pYy1mb3JtLWNvbnRyb2wtbGF5b3V0Lm1vZGVsXCI7XG5pbXBvcnQgeyBEeW5hbWljRm9ybUNvbnRyb2xNb2RlbCB9IGZyb20gXCIuLi9tb2RlbC9keW5hbWljLWZvcm0tY29udHJvbC5tb2RlbFwiO1xuaW1wb3J0IHsgRHluYW1pY0Zvcm1BcnJheUdyb3VwTW9kZWwgfSBmcm9tIFwiLi4vbW9kZWwvZm9ybS1hcnJheS9keW5hbWljLWZvcm0tYXJyYXkubW9kZWxcIjtcbmltcG9ydCB7XG4gICAgRHluYW1pY1RlbXBsYXRlRGlyZWN0aXZlLFxuICAgIERZTkFNSUNfVEVNUExBVEVfRElSRUNUSVZFX0FMSUdOTUVOVFxufSBmcm9tIFwiLi4vZGlyZWN0aXZlL2R5bmFtaWMtdGVtcGxhdGUuZGlyZWN0aXZlXCI7XG5pbXBvcnQgeyBpc09iamVjdCB9IGZyb20gXCIuLi91dGlscy9jb3JlLnV0aWxzXCI7XG5cbmV4cG9ydCB0eXBlIER5bmFtaWNGb3JtTGF5b3V0ID0geyBbaWQ6IHN0cmluZ106IER5bmFtaWNGb3JtQ29udHJvbExheW91dCB9O1xuXG5leHBvcnQgdHlwZSBEeW5hbWljRm9ybUNvbnRyb2xUZW1wbGF0ZXMgPSBRdWVyeUxpc3Q8RHluYW1pY1RlbXBsYXRlRGlyZWN0aXZlPiB8IER5bmFtaWNUZW1wbGF0ZURpcmVjdGl2ZVtdIHwgdW5kZWZpbmVkO1xuXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogXCJyb290XCJcbn0pXG5leHBvcnQgY2xhc3MgRHluYW1pY0Zvcm1MYXlvdXRTZXJ2aWNlIHtcblxuICAgIGZpbmRCeUlkKGlkOiBzdHJpbmcsIGZvcm1MYXlvdXQ6IER5bmFtaWNGb3JtTGF5b3V0IHwgbnVsbCk6IER5bmFtaWNGb3JtQ29udHJvbExheW91dCB8IG51bGwge1xuXG4gICAgICAgIGlmIChpc09iamVjdChmb3JtTGF5b3V0KSkge1xuXG4gICAgICAgICAgICBmb3IgKGxldCBrZXkgb2YgT2JqZWN0LmtleXMoZm9ybUxheW91dCkpIHtcblxuICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JtTGF5b3V0W2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgZmluZEJ5TW9kZWwobW9kZWw6IER5bmFtaWNGb3JtQ29udHJvbE1vZGVsLCBmb3JtTGF5b3V0OiBEeW5hbWljRm9ybUxheW91dCB8IG51bGwpOiBEeW5hbWljRm9ybUNvbnRyb2xMYXlvdXQgfCBudWxsIHtcblxuICAgICAgICBsZXQgY29udHJvbExheW91dDogRHluYW1pY0Zvcm1Db250cm9sTGF5b3V0ID0gbnVsbDtcblxuICAgICAgICBpZiAoaXNPYmplY3QoZm9ybUxheW91dCkpIHtcblxuICAgICAgICAgICAgZm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKGZvcm1MYXlvdXQpKSB7XG5cbiAgICAgICAgICAgICAgICBrZXkuc3BsaXQoXCIsXCIpLmZvckVhY2goc3Vic3RyaW5nID0+IHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IHN1YnN0cmluZy50cmltKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdG9yID09PSBtb2RlbC5pZCB8fCBzZWxlY3RvciA9PT0gbW9kZWwudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbExheW91dCA9IGZvcm1MYXlvdXRba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRyb2xMYXlvdXQ7XG4gICAgfVxuXG4gICAgZmlsdGVyVGVtcGxhdGVzQnlNb2RlbChtb2RlbDogRHluYW1pY0Zvcm1Db250cm9sTW9kZWwsIHRlbXBsYXRlczogRHluYW1pY0Zvcm1Db250cm9sVGVtcGxhdGVzKTogRHluYW1pY1RlbXBsYXRlRGlyZWN0aXZlW10ge1xuXG4gICAgICAgIGNvbnN0IGZpbHRlckNhbGxiYWNrOiAodGVtcGxhdGU6IER5bmFtaWNUZW1wbGF0ZURpcmVjdGl2ZSkgPT4gYm9vbGVhbiA9ICh0ZW1wbGF0ZTogRHluYW1pY1RlbXBsYXRlRGlyZWN0aXZlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUubW9kZWxJZCA9PT0gbW9kZWwuaWQgfHwgdGVtcGxhdGUubW9kZWxUeXBlID09PSBtb2RlbC50eXBlO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0ZW1wbGF0ZXMgaW5zdGFuY2VvZiBRdWVyeUxpc3QpIHtcbiAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXMuZmlsdGVyKGZpbHRlckNhbGxiYWNrKTtcblxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodGVtcGxhdGVzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRlbXBsYXRlcy5maWx0ZXIoZmlsdGVyQ2FsbGJhY2spO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGdldEFsaWduZWRUZW1wbGF0ZShtb2RlbDogRHluYW1pY0Zvcm1Db250cm9sTW9kZWwsIHRlbXBsYXRlczogRHluYW1pY0Zvcm1Db250cm9sVGVtcGxhdGVzLCBhbGlnbm1lbnQ6IERZTkFNSUNfVEVNUExBVEVfRElSRUNUSVZFX0FMSUdOTUVOVCk6IER5bmFtaWNUZW1wbGF0ZURpcmVjdGl2ZSB8IHVuZGVmaW5lZCB7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyVGVtcGxhdGVzQnlNb2RlbChtb2RlbCwgdGVtcGxhdGVzKVxuICAgICAgICAgICAgLmZpbmQodGVtcGxhdGUgPT4gdGVtcGxhdGUuYXMgPT09IG51bGwgJiYgdGVtcGxhdGUuYWxpZ24gPT09IGFsaWdubWVudCk7XG4gICAgfVxuXG4gICAgLypcbiAgICBnZXRJbmRleGVkVGVtcGxhdGVzKG1vZGVsOiBEeW5hbWljRm9ybUNvbnRyb2xNb2RlbCwgdGVtcGxhdGVzOiBEeW5hbWljRm9ybUNvbnRyb2xUZW1wbGF0ZXMpOiBEeW5hbWljVGVtcGxhdGVEaXJlY3RpdmVbXSB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlclRlbXBsYXRlc0J5TW9kZWwobW9kZWwsIHRlbXBsYXRlcykuZmlsdGVyKHRlbXBsYXRlID0+IHRlbXBsYXRlLmFzID09PSBudWxsKTtcbiAgICB9XG4gICAgKi9cbiAgICBnZXRTdGFydFRlbXBsYXRlKG1vZGVsOiBEeW5hbWljRm9ybUNvbnRyb2xNb2RlbCwgdGVtcGxhdGVzOiBEeW5hbWljRm9ybUNvbnRyb2xUZW1wbGF0ZXMpOiBEeW5hbWljVGVtcGxhdGVEaXJlY3RpdmUgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGlnbmVkVGVtcGxhdGUobW9kZWwsIHRlbXBsYXRlcywgRFlOQU1JQ19URU1QTEFURV9ESVJFQ1RJVkVfQUxJR05NRU5ULlN0YXJ0KTtcbiAgICB9XG5cbiAgICBnZXRFbmRUZW1wbGF0ZShtb2RlbDogRHluYW1pY0Zvcm1Db250cm9sTW9kZWwsIHRlbXBsYXRlczogRHluYW1pY0Zvcm1Db250cm9sVGVtcGxhdGVzKTogRHluYW1pY1RlbXBsYXRlRGlyZWN0aXZlIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxpZ25lZFRlbXBsYXRlKG1vZGVsLCB0ZW1wbGF0ZXMsIERZTkFNSUNfVEVNUExBVEVfRElSRUNUSVZFX0FMSUdOTUVOVC5FbmQpO1xuICAgIH1cblxuICAgIGdldENsYXNzKGxheW91dDogRHluYW1pY0Zvcm1Db250cm9sTGF5b3V0IHwgbnVsbCwgY29udGV4dDogRHluYW1pY0Zvcm1Db250cm9sTGF5b3V0Q29udGV4dCwgcGxhY2U6IER5bmFtaWNGb3JtQ29udHJvbExheW91dFBsYWNlKTogc3RyaW5nIHtcblxuICAgICAgICBpZiAobGF5b3V0ICE9PSBudWxsICYmIGxheW91dC5oYXNPd25Qcm9wZXJ0eShjb250ZXh0KSkge1xuXG4gICAgICAgICAgICBsZXQgY29uZmlnID0gbGF5b3V0W2NvbnRleHRdIGFzIER5bmFtaWNGb3JtQ29udHJvbExheW91dENvbmZpZztcblxuICAgICAgICAgICAgaWYgKGNvbmZpZy5oYXNPd25Qcm9wZXJ0eShwbGFjZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZmlnW3BsYWNlXSBhcyBzdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG5cbiAgICBnZXRFbGVtZW50SWQobW9kZWw6IER5bmFtaWNGb3JtQ29udHJvbE1vZGVsKTogc3RyaW5nIHtcblxuICAgICAgICBsZXQgaWQgPSBtb2RlbC5pZCwgcGFyZW50ID0gbW9kZWwucGFyZW50O1xuXG4gICAgICAgIHdoaWxlIChwYXJlbnQgIT09IG51bGwpIHtcblxuICAgICAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIER5bmFtaWNGb3JtQXJyYXlHcm91cE1vZGVsKSB7XG5cbiAgICAgICAgICAgICAgICBpZCA9IGAke3BhcmVudC5jb250ZXh0LmlkfS0ke3BhcmVudC5pbmRleH0tJHttb2RlbC5pZH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH1cbn1cbiJdfQ==