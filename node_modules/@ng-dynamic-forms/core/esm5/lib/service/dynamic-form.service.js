/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from "@angular/core";
import { FormArray, FormControl, FormGroup } from "@angular/forms";
import { DynamicFormArrayModel, DYNAMIC_FORM_CONTROL_TYPE_ARRAY, DynamicFormArrayGroupModel } from "../model/form-array/dynamic-form-array.model";
import { DYNAMIC_FORM_CONTROL_TYPE_GROUP, DynamicFormGroupModel } from "../model/form-group/dynamic-form-group.model";
import { DYNAMIC_FORM_CONTROL_TYPE_CHECKBOX_GROUP, DynamicCheckboxGroupModel } from "../model/checkbox/dynamic-checkbox-group.model";
import { DYNAMIC_FORM_CONTROL_TYPE_CHECKBOX, DynamicCheckboxModel } from "../model/checkbox/dynamic-checkbox.model";
import { DYNAMIC_FORM_CONTROL_TYPE_COLORPICKER, DynamicColorPickerModel } from "../model/colorpicker/dynamic-colorpicker.model";
import { DYNAMIC_FORM_CONTROL_TYPE_DATEPICKER, DynamicDatePickerModel } from "../model/datepicker/dynamic-datepicker.model";
import { DYNAMIC_FORM_CONTROL_TYPE_EDITOR, DynamicEditorModel } from "../model/editor/dynamic-editor.model";
import { DYNAMIC_FORM_CONTROL_TYPE_FILE_UPLOAD, DynamicFileUploadModel } from "../model/file-upload/dynamic-file-upload.model";
import { DYNAMIC_FORM_CONTROL_TYPE_INPUT, DynamicInputModel } from "../model/input/dynamic-input.model";
import { DYNAMIC_FORM_CONTROL_TYPE_RADIO_GROUP, DynamicRadioGroupModel } from "../model/radio/dynamic-radio-group.model";
import { DYNAMIC_FORM_CONTROL_TYPE_RATING, DynamicRatingModel } from "../model/rating/dynamic-rating.model";
import { DYNAMIC_FORM_CONTROL_TYPE_SELECT, DynamicSelectModel } from "../model/select/dynamic-select.model";
import { DYNAMIC_FORM_CONTROL_TYPE_SLIDER, DynamicSliderModel } from "../model/slider/dynamic-slider.model";
import { DYNAMIC_FORM_CONTROL_TYPE_SWITCH, DynamicSwitchModel } from "../model/switch/dynamic-switch.model";
import { DYNAMIC_FORM_CONTROL_TYPE_TEXTAREA, DynamicTextAreaModel } from "../model/textarea/dynamic-textarea.model";
import { DYNAMIC_FORM_CONTROL_TYPE_TIMEPICKER, DynamicTimePickerModel } from "../model/timepicker/dynamic-timepicker.model";
import { DynamicFormValidationService } from "./dynamic-form-validation.service";
import { maskFromString, parseReviver } from "../utils/json.utils";
import { isString } from "../utils/core.utils";
import * as i0 from "@angular/core";
import * as i1 from "./dynamic-form-validation.service";
var DynamicFormService = /** @class */ (function () {
    function DynamicFormService(validationService) {
        this.validationService = validationService;
    }
    /**
     * @private
     * @param {?=} validatorsConfig
     * @param {?=} asyncValidatorsConfig
     * @param {?=} updateOn
     * @return {?}
     */
    DynamicFormService.prototype.createAbstractControlOptions = /**
     * @private
     * @param {?=} validatorsConfig
     * @param {?=} asyncValidatorsConfig
     * @param {?=} updateOn
     * @return {?}
     */
    function (validatorsConfig, asyncValidatorsConfig, updateOn) {
        if (validatorsConfig === void 0) { validatorsConfig = null; }
        if (asyncValidatorsConfig === void 0) { asyncValidatorsConfig = null; }
        if (updateOn === void 0) { updateOn = null; }
        return {
            asyncValidators: asyncValidatorsConfig !== null ? this.validationService.getAsyncValidators(asyncValidatorsConfig) : null,
            validators: validatorsConfig !== null ? this.validationService.getValidators(validatorsConfig) : null,
            updateOn: updateOn !== null && this.validationService.isFormHook(updateOn) ? updateOn : "change"
        };
    };
    /**
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.createFormArray = /**
     * @param {?} formArrayModel
     * @return {?}
     */
    function (formArrayModel) {
        /** @type {?} */
        var controls = [];
        /** @type {?} */
        var options = this.createAbstractControlOptions(formArrayModel.validators, formArrayModel.asyncValidators, formArrayModel.updateOn);
        for (var index = 0; index < formArrayModel.size; index++) {
            /** @type {?} */
            var groupModel = formArrayModel.get(index);
            /** @type {?} */
            var groupOptions = this.createAbstractControlOptions(formArrayModel.groupValidators, formArrayModel.groupAsyncValidators, formArrayModel.updateOn);
            controls.push(this.createFormGroup(groupModel.group, groupOptions, groupModel));
        }
        return new FormArray(controls, options);
    };
    /**
     * @param {?} formModel
     * @param {?=} options
     * @param {?=} parent
     * @return {?}
     */
    DynamicFormService.prototype.createFormGroup = /**
     * @param {?} formModel
     * @param {?=} options
     * @param {?=} parent
     * @return {?}
     */
    function (formModel, options, parent) {
        var _this = this;
        if (options === void 0) { options = null; }
        if (parent === void 0) { parent = null; }
        /** @type {?} */
        var controls = {};
        formModel.forEach((/**
         * @param {?} model
         * @return {?}
         */
        function (model) {
            model.parent = parent;
            switch (model.type) {
                case DYNAMIC_FORM_CONTROL_TYPE_ARRAY:
                    controls[model.id] = _this.createFormArray((/** @type {?} */ (model)));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_GROUP:
                case DYNAMIC_FORM_CONTROL_TYPE_CHECKBOX_GROUP:
                    /** @type {?} */
                    var groupModel = (/** @type {?} */ (model));
                    /** @type {?} */
                    var groupOptions = _this.createAbstractControlOptions(groupModel.validators, groupModel.asyncValidators, groupModel.updateOn);
                    controls[model.id] = _this.createFormGroup(groupModel.group, groupOptions, groupModel);
                    break;
                default:
                    /** @type {?} */
                    var controlModel = (/** @type {?} */ (model));
                    /** @type {?} */
                    var controlState = { value: controlModel.value, disabled: controlModel.disabled };
                    /** @type {?} */
                    var controlOptions = _this.createAbstractControlOptions(controlModel.validators, controlModel.asyncValidators, controlModel.updateOn);
                    controls[model.id] = new FormControl(controlState, controlOptions);
            }
        }));
        return new FormGroup(controls, options);
    };
    /**
     * @param {?} model
     * @return {?}
     */
    DynamicFormService.prototype.getPathSegment = /**
     * @param {?} model
     * @return {?}
     */
    function (model) {
        return model instanceof DynamicFormArrayGroupModel ? model.index.toString() : ((/** @type {?} */ (model))).id;
    };
    /**
     * @param {?} model
     * @param {?=} join
     * @return {?}
     */
    DynamicFormService.prototype.getPath = /**
     * @param {?} model
     * @param {?=} join
     * @return {?}
     */
    function (model, join) {
        if (join === void 0) { join = false; }
        /** @type {?} */
        var path = [this.getPathSegment(model)];
        /** @type {?} */
        var parent = model.parent;
        while (parent) {
            path.unshift(this.getPathSegment(parent));
            parent = parent.parent;
        }
        return join ? path.join(".") : path;
    };
    /**
     * @param {?} formGroup
     * @param {?} formModel
     * @param {...?} models
     * @return {?}
     */
    DynamicFormService.prototype.addFormGroupControl = /**
     * @param {?} formGroup
     * @param {?} formModel
     * @param {...?} models
     * @return {?}
     */
    function (formGroup, formModel) {
        var models = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            models[_i - 2] = arguments[_i];
        }
        if (formModel instanceof DynamicFormGroupModel) {
            this.insertFormGroupControl.apply(this, tslib_1.__spread([formModel.size(), formGroup, formModel], models));
        }
        else {
            /** @type {?} */
            var _formModel = (/** @type {?} */ (formModel));
            this.insertFormGroupControl.apply(this, tslib_1.__spread([_formModel.length, formGroup, _formModel], models));
        }
    };
    /**
     * @param {?} index
     * @param {?} step
     * @param {?} formModel
     * @return {?}
     */
    DynamicFormService.prototype.moveFormGroupControl = /**
     * @param {?} index
     * @param {?} step
     * @param {?} formModel
     * @return {?}
     */
    function (index, step, formModel) {
        if (formModel instanceof DynamicFormGroupModel) {
            formModel.move(index, step);
        }
        else {
            /** @type {?} */
            var _formModel = (/** @type {?} */ (formModel));
            _formModel.splice.apply(_formModel, tslib_1.__spread([index + step, 0], _formModel.splice(index, 1)));
        }
    };
    /**
     * @param {?} index
     * @param {?} formGroup
     * @param {?} formModel
     * @param {...?} models
     * @return {?}
     */
    DynamicFormService.prototype.insertFormGroupControl = /**
     * @param {?} index
     * @param {?} formGroup
     * @param {?} formModel
     * @param {...?} models
     * @return {?}
     */
    function (index, formGroup, formModel) {
        var models = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            models[_i - 3] = arguments[_i];
        }
        /** @type {?} */
        var parent = formModel instanceof DynamicFormGroupModel ? formModel : null;
        /** @type {?} */
        var controls = this.createFormGroup(models, null, parent).controls;
        Object.keys(controls).forEach((/**
         * @param {?} controlName
         * @param {?} idx
         * @return {?}
         */
        function (controlName, idx) {
            /** @type {?} */
            var controlModel = models[idx];
            if (formModel instanceof DynamicFormGroupModel) {
                formModel.insert(index, controlModel);
            }
            else {
                ((/** @type {?} */ (formModel))).splice(index, 0, controlModel);
            }
            formGroup.addControl(controlName, controls[controlName]);
        }));
    };
    /**
     * @param {?} index
     * @param {?} formGroup
     * @param {?} formModel
     * @return {?}
     */
    DynamicFormService.prototype.removeFormGroupControl = /**
     * @param {?} index
     * @param {?} formGroup
     * @param {?} formModel
     * @return {?}
     */
    function (index, formGroup, formModel) {
        if (formModel instanceof DynamicFormGroupModel) {
            formGroup.removeControl(formModel.get(index).id);
            formModel.remove(index);
        }
        else {
            formGroup.removeControl(formModel[index].id);
            ((/** @type {?} */ (formModel))).splice(index, 1);
        }
    };
    /**
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.addFormArrayGroup = /**
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    function (formArray, formArrayModel) {
        /** @type {?} */
        var groupModel = formArrayModel.addGroup();
        formArray.push(this.createFormGroup(groupModel.group, null, groupModel));
    };
    /**
     * @param {?} index
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.insertFormArrayGroup = /**
     * @param {?} index
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    function (index, formArray, formArrayModel) {
        /** @type {?} */
        var groupModel = formArrayModel.insertGroup(index);
        formArray.insert(index, this.createFormGroup(groupModel.group, null, groupModel));
    };
    /**
     * @param {?} index
     * @param {?} step
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.moveFormArrayGroup = /**
     * @param {?} index
     * @param {?} step
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    function (index, step, formArray, formArrayModel) {
        /** @type {?} */
        var newIndex = index + step;
        /** @type {?} */
        var moveUp = step >= 0;
        if ((index >= 0 && index < formArrayModel.size) && (newIndex >= 0 && newIndex < formArrayModel.size)) {
            /** @type {?} */
            var movingGroups_1 = [];
            for (var i = moveUp ? index : newIndex; i <= (moveUp ? newIndex : index); i++) {
                movingGroups_1.push(formArray.at(i));
            }
            movingGroups_1.forEach((/**
             * @param {?} formControl
             * @param {?} idx
             * @return {?}
             */
            function (formControl, idx) {
                /** @type {?} */
                var position;
                if (moveUp) {
                    position = idx === 0 ? newIndex : index + idx - 1;
                }
                else {
                    position = idx === movingGroups_1.length - 1 ? newIndex : newIndex + idx + 1;
                }
                formArray.setControl(position, formControl);
            }));
            formArrayModel.moveGroup(index, step);
        }
        else {
            throw new Error("form array group cannot be moved due to index or new index being out of bounds");
        }
    };
    /**
     * @param {?} index
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.removeFormArrayGroup = /**
     * @param {?} index
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    function (index, formArray, formArrayModel) {
        formArray.removeAt(index);
        formArrayModel.removeGroup(index);
    };
    /**
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    DynamicFormService.prototype.clearFormArray = /**
     * @param {?} formArray
     * @param {?} formArrayModel
     * @return {?}
     */
    function (formArray, formArrayModel) {
        formArray.clear();
        formArrayModel.clear();
    };
    /**
     * @param {?} id
     * @param {?} formModel
     * @return {?}
     */
    DynamicFormService.prototype.findById = /**
     * @param {?} id
     * @param {?} formModel
     * @return {?}
     */
    function (id, formModel) {
        /** @type {?} */
        var result = null;
        /** @type {?} */
        var findByIdFn = (/**
         * @param {?} id
         * @param {?} groupModel
         * @return {?}
         */
        function (id, groupModel) {
            var e_1, _a;
            try {
                for (var groupModel_1 = tslib_1.__values(groupModel), groupModel_1_1 = groupModel_1.next(); !groupModel_1_1.done; groupModel_1_1 = groupModel_1.next()) {
                    var controlModel = groupModel_1_1.value;
                    if (controlModel.id === id) {
                        result = controlModel;
                        break;
                    }
                    if (controlModel instanceof DynamicFormGroupModel) {
                        findByIdFn(id, ((/** @type {?} */ (controlModel))).group);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (groupModel_1_1 && !groupModel_1_1.done && (_a = groupModel_1.return)) _a.call(groupModel_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        });
        findByIdFn(id, formModel);
        return result;
    };
    /**
     * @param {?} id
     * @param {?} formModel
     * @return {?}
     */
    DynamicFormService.prototype.findModelById = /**
     * @param {?} id
     * @param {?} formModel
     * @return {?}
     */
    function (id, formModel) {
        return this.findById(id, formModel);
    };
    /**
     * @param {?} model
     * @param {?} group
     * @return {?}
     */
    DynamicFormService.prototype.findControlByModel = /**
     * @param {?} model
     * @param {?} group
     * @return {?}
     */
    function (model, group) {
        return group.root.get(this.getPath(model, true));
    };
    /**
     * @param {?} json
     * @return {?}
     */
    DynamicFormService.prototype.fromJSON = /**
     * @param {?} json
     * @return {?}
     */
    function (json) {
        var _this = this;
        /** @type {?} */
        var formModelJSON = isString(json) ? JSON.parse(json, parseReviver) : json;
        /** @type {?} */
        var formModel = [];
        formModelJSON.forEach((/**
         * @param {?} model
         * @return {?}
         */
        function (model) {
            /** @type {?} */
            var layout = model.layout || null;
            switch (model.type) {
                case DYNAMIC_FORM_CONTROL_TYPE_ARRAY:
                    /** @type {?} */
                    var formArrayModel_1 = (/** @type {?} */ (model));
                    if (Array.isArray(formArrayModel_1.groups)) {
                        formArrayModel_1.groups.forEach((/**
                         * @param {?} groupModel
                         * @return {?}
                         */
                        function (groupModel) {
                            groupModel.group = (/** @type {?} */ (_this.fromJSON(groupModel.group)));
                        }));
                    }
                    formArrayModel_1.groupFactory = (/**
                     * @return {?}
                     */
                    function () {
                        return _this.fromJSON(formArrayModel_1.groupPrototype);
                    });
                    formModel.push(new DynamicFormArrayModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_CHECKBOX:
                    formModel.push(new DynamicCheckboxModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_CHECKBOX_GROUP:
                    model.group = (/** @type {?} */ (_this.fromJSON(model.group)));
                    formModel.push(new DynamicCheckboxGroupModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_COLORPICKER:
                    formModel.push(new DynamicColorPickerModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_DATEPICKER:
                    formModel.push(new DynamicDatePickerModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_EDITOR:
                    formModel.push(new DynamicEditorModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_FILE_UPLOAD:
                    model.value = null;
                    formModel.push(new DynamicFileUploadModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_GROUP:
                    model.group = _this.fromJSON(model.group);
                    formModel.push(new DynamicFormGroupModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_INPUT:
                    /** @type {?} */
                    var inputModel = (/** @type {?} */ (model));
                    if (inputModel.mask !== null) {
                        if (!(inputModel.mask instanceof Function)) {
                            inputModel.mask = maskFromString((/** @type {?} */ (inputModel.mask)));
                        }
                    }
                    formModel.push(new DynamicInputModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_RADIO_GROUP:
                    formModel.push(new DynamicRadioGroupModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_RATING:
                    formModel.push(new DynamicRatingModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_SELECT:
                    formModel.push(new DynamicSelectModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_SLIDER:
                    formModel.push(new DynamicSliderModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_SWITCH:
                    formModel.push(new DynamicSwitchModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_TEXTAREA:
                    formModel.push(new DynamicTextAreaModel(model, layout));
                    break;
                case DYNAMIC_FORM_CONTROL_TYPE_TIMEPICKER:
                    formModel.push(new DynamicTimePickerModel(model, layout));
                    break;
                default:
                    throw new Error("unknown form control model type defined on JSON object with id \"" + model.id + "\"");
            }
        }));
        return formModel;
    };
    DynamicFormService.decorators = [
        { type: Injectable, args: [{
                    providedIn: "root"
                },] }
    ];
    /** @nocollapse */
    DynamicFormService.ctorParameters = function () { return [
        { type: DynamicFormValidationService }
    ]; };
    /** @nocollapse */ DynamicFormService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function DynamicFormService_Factory() { return new DynamicFormService(i0.ɵɵinject(i1.DynamicFormValidationService)); }, token: DynamicFormService, providedIn: "root" });
    return DynamicFormService;
}());
export { DynamicFormService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DynamicFormService.prototype.validationService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy1mb3JtLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AbmctZHluYW1pYy1mb3Jtcy9jb3JlLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvZHluYW1pYy1mb3JtLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBbUIsU0FBUyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUlwRixPQUFPLEVBQ0gscUJBQXFCLEVBQ3JCLCtCQUErQixFQUMvQiwwQkFBMEIsRUFDN0IsTUFBTSw4Q0FBOEMsQ0FBQztBQUN0RCxPQUFPLEVBQUUsK0JBQStCLEVBQUUscUJBQXFCLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUN0SCxPQUFPLEVBQ0gsd0NBQXdDLEVBQ3hDLHlCQUF5QixFQUM1QixNQUFNLGdEQUFnRCxDQUFDO0FBQ3hELE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBQ3BILE9BQU8sRUFDSCxxQ0FBcUMsRUFDckMsdUJBQXVCLEVBQzFCLE1BQU0sZ0RBQWdELENBQUM7QUFDeEQsT0FBTyxFQUNILG9DQUFvQyxFQUNwQyxzQkFBc0IsRUFDekIsTUFBTSw4Q0FBOEMsQ0FBQztBQUN0RCxPQUFPLEVBQUUsZ0NBQWdDLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUM1RyxPQUFPLEVBQ0gscUNBQXFDLEVBQ3JDLHNCQUFzQixFQUN6QixNQUFNLGdEQUFnRCxDQUFDO0FBQ3hELE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQ3hHLE9BQU8sRUFDSCxxQ0FBcUMsRUFDckMsc0JBQXNCLEVBQ3pCLE1BQU0sMENBQTBDLENBQUM7QUFDbEQsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLGtCQUFr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O29CQUNqQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksa0JBQWtCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7b0JBQ3RELE1BQU07Z0JBRVYsS0FBSyxrQ0FBa0M7b0JBQ25DLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxvQkFBb0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztvQkFDeEQsTUFBTTtnQkFFVixLQUFLLG9DQUFvQztvQkFDckMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLHNCQUFzQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO29CQUMxRCxNQUFNO2dCQUVWO29CQUNJLE1BQU0sSUFBSSxLQUFLLENBQUMsc0VBQW1FLEtBQUssQ0FBQyxFQUFFLE9BQUcsQ0FBQyxDQUFDO2FBQ3ZHO1FBQ0wsQ0FBQyxFQUFDLENBQUM7UUFFSCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDOztnQkFwWEosVUFBVSxTQUFDO29CQUNSLFVBQVUsRUFBRSxNQUFNO2lCQUNyQjs7OztnQkFUUSw0QkFBNEI7Ozs2QkEzQ3JDO0NBdWFDLEFBclhELElBcVhDO1NBbFhZLGtCQUFrQjs7Ozs7O0lBRWYsK0NBQXVEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wsIEZvcm1BcnJheSwgRm9ybUNvbnRyb2wsIEZvcm1Hcm91cCB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xuaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sT3B0aW9ucyB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xuaW1wb3J0IHsgRHluYW1pY0Zvcm1Db250cm9sTW9kZWwsIEZvcm1Ib29rcyB9IGZyb20gXCIuLi9tb2RlbC9keW5hbWljLWZvcm0tY29udHJvbC5tb2RlbFwiO1xuaW1wb3J0IHsgRHluYW1pY0Zvcm1WYWx1ZUNvbnRyb2xNb2RlbCB9IGZyb20gXCIuLi9tb2RlbC9keW5hbWljLWZvcm0tdmFsdWUtY29udHJvbC5tb2RlbFwiO1xuaW1wb3J0IHtcbiAgICBEeW5hbWljRm9ybUFycmF5TW9kZWwsXG4gICAgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9BUlJBWSxcbiAgICBEeW5hbWljRm9ybUFycmF5R3JvdXBNb2RlbFxufSBmcm9tIFwiLi4vbW9kZWwvZm9ybS1hcnJheS9keW5hbWljLWZvcm0tYXJyYXkubW9kZWxcIjtcbmltcG9ydCB7IERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfR1JPVVAsIER5bmFtaWNGb3JtR3JvdXBNb2RlbCB9IGZyb20gXCIuLi9tb2RlbC9mb3JtLWdyb3VwL2R5bmFtaWMtZm9ybS1ncm91cC5tb2RlbFwiO1xuaW1wb3J0IHtcbiAgICBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0NIRUNLQk9YX0dST1VQLFxuICAgIER5bmFtaWNDaGVja2JveEdyb3VwTW9kZWxcbn0gZnJvbSBcIi4uL21vZGVsL2NoZWNrYm94L2R5bmFtaWMtY2hlY2tib3gtZ3JvdXAubW9kZWxcIjtcbmltcG9ydCB7IERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfQ0hFQ0tCT1gsIER5bmFtaWNDaGVja2JveE1vZGVsIH0gZnJvbSBcIi4uL21vZGVsL2NoZWNrYm94L2R5bmFtaWMtY2hlY2tib3gubW9kZWxcIjtcbmltcG9ydCB7XG4gICAgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9DT0xPUlBJQ0tFUixcbiAgICBEeW5hbWljQ29sb3JQaWNrZXJNb2RlbFxufSBmcm9tIFwiLi4vbW9kZWwvY29sb3JwaWNrZXIvZHluYW1pYy1jb2xvcnBpY2tlci5tb2RlbFwiO1xuaW1wb3J0IHtcbiAgICBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0RBVEVQSUNLRVIsXG4gICAgRHluYW1pY0RhdGVQaWNrZXJNb2RlbFxufSBmcm9tIFwiLi4vbW9kZWwvZGF0ZXBpY2tlci9keW5hbWljLWRhdGVwaWNrZXIubW9kZWxcIjtcbmltcG9ydCB7IERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfRURJVE9SLCBEeW5hbWljRWRpdG9yTW9kZWwgfSBmcm9tIFwiLi4vbW9kZWwvZWRpdG9yL2R5bmFtaWMtZWRpdG9yLm1vZGVsXCI7XG5pbXBvcnQge1xuICAgIERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfRklMRV9VUExPQUQsXG4gICAgRHluYW1pY0ZpbGVVcGxvYWRNb2RlbFxufSBmcm9tIFwiLi4vbW9kZWwvZmlsZS11cGxvYWQvZHluYW1pYy1maWxlLXVwbG9hZC5tb2RlbFwiO1xuaW1wb3J0IHsgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9JTlBVVCwgRHluYW1pY0lucHV0TW9kZWwgfSBmcm9tIFwiLi4vbW9kZWwvaW5wdXQvZHluYW1pYy1pbnB1dC5tb2RlbFwiO1xuaW1wb3J0IHtcbiAgICBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1JBRElPX0dST1VQLFxuICAgIER5bmFtaWNSYWRpb0dyb3VwTW9kZWxcbn0gZnJvbSBcIi4uL21vZGVsL3JhZGlvL2R5bmFtaWMtcmFkaW8tZ3JvdXAubW9kZWxcIjtcbmltcG9ydCB7IERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfUkFUSU5HLCBEeW5hbWljUmF0aW5nTW9kZWwgfSBmcm9tIFwiLi4vbW9kZWwvcmF0aW5nL2R5bmFtaWMtcmF0aW5nLm1vZGVsXCI7XG5pbXBvcnQgeyBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1NFTEVDVCwgRHluYW1pY1NlbGVjdE1vZGVsIH0gZnJvbSBcIi4uL21vZGVsL3NlbGVjdC9keW5hbWljLXNlbGVjdC5tb2RlbFwiO1xuaW1wb3J0IHsgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9TTElERVIsIER5bmFtaWNTbGlkZXJNb2RlbCB9IGZyb20gXCIuLi9tb2RlbC9zbGlkZXIvZHluYW1pYy1zbGlkZXIubW9kZWxcIjtcbmltcG9ydCB7IERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfU1dJVENILCBEeW5hbWljU3dpdGNoTW9kZWwgfSBmcm9tIFwiLi4vbW9kZWwvc3dpdGNoL2R5bmFtaWMtc3dpdGNoLm1vZGVsXCI7XG5pbXBvcnQgeyBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1RFWFRBUkVBLCBEeW5hbWljVGV4dEFyZWFNb2RlbCB9IGZyb20gXCIuLi9tb2RlbC90ZXh0YXJlYS9keW5hbWljLXRleHRhcmVhLm1vZGVsXCI7XG5pbXBvcnQge1xuICAgIERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfVElNRVBJQ0tFUixcbiAgICBEeW5hbWljVGltZVBpY2tlck1vZGVsXG59IGZyb20gXCIuLi9tb2RlbC90aW1lcGlja2VyL2R5bmFtaWMtdGltZXBpY2tlci5tb2RlbFwiO1xuaW1wb3J0IHsgRHluYW1pY0Zvcm1WYWxpZGF0aW9uU2VydmljZSB9IGZyb20gXCIuL2R5bmFtaWMtZm9ybS12YWxpZGF0aW9uLnNlcnZpY2VcIjtcbmltcG9ydCB7IER5bmFtaWNGb3JtTW9kZWwsIER5bmFtaWNVbmlvbkZvcm1Nb2RlbCB9IGZyb20gXCIuLi9tb2RlbC9keW5hbWljLWZvcm0ubW9kZWxcIjtcbmltcG9ydCB7IER5bmFtaWNQYXRoYWJsZSB9IGZyb20gXCIuLi9tb2RlbC9taXNjL2R5bmFtaWMtZm9ybS1jb250cm9sLXBhdGgubW9kZWxcIjtcbmltcG9ydCB7IER5bmFtaWNWYWxpZGF0b3JzQ29uZmlnIH0gZnJvbSBcIi4uL21vZGVsL21pc2MvZHluYW1pYy1mb3JtLWNvbnRyb2wtdmFsaWRhdGlvbi5tb2RlbFwiO1xuaW1wb3J0IHsgbWFza0Zyb21TdHJpbmcsIHBhcnNlUmV2aXZlciB9IGZyb20gXCIuLi91dGlscy9qc29uLnV0aWxzXCI7XG5pbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gXCIuLi91dGlscy9jb3JlLnV0aWxzXCI7XG5cbkBJbmplY3RhYmxlKHtcbiAgICBwcm92aWRlZEluOiBcInJvb3RcIlxufSlcbmV4cG9ydCBjbGFzcyBEeW5hbWljRm9ybVNlcnZpY2Uge1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB2YWxpZGF0aW9uU2VydmljZTogRHluYW1pY0Zvcm1WYWxpZGF0aW9uU2VydmljZSkge31cblxuXG4gICAgcHJpdmF0ZSBjcmVhdGVBYnN0cmFjdENvbnRyb2xPcHRpb25zKHZhbGlkYXRvcnNDb25maWc6IER5bmFtaWNWYWxpZGF0b3JzQ29uZmlnIHwgbnVsbCA9IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jVmFsaWRhdG9yc0NvbmZpZzogRHluYW1pY1ZhbGlkYXRvcnNDb25maWcgfCBudWxsID0gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlT246IEZvcm1Ib29rcyB8IG51bGwgPSBudWxsKTogQWJzdHJhY3RDb250cm9sT3B0aW9ucyB7XG5cbiAgICAgICAgcmV0dXJuIHtcblxuICAgICAgICAgICAgYXN5bmNWYWxpZGF0b3JzOiBhc3luY1ZhbGlkYXRvcnNDb25maWcgIT09IG51bGwgPyB0aGlzLnZhbGlkYXRpb25TZXJ2aWNlLmdldEFzeW5jVmFsaWRhdG9ycyhhc3luY1ZhbGlkYXRvcnNDb25maWcpIDogbnVsbCxcblxuICAgICAgICAgICAgdmFsaWRhdG9yczogdmFsaWRhdG9yc0NvbmZpZyAhPT0gbnVsbCA/IHRoaXMudmFsaWRhdGlvblNlcnZpY2UuZ2V0VmFsaWRhdG9ycyh2YWxpZGF0b3JzQ29uZmlnKSA6IG51bGwsXG5cbiAgICAgICAgICAgIHVwZGF0ZU9uOiB1cGRhdGVPbiAhPT0gbnVsbCAmJiB0aGlzLnZhbGlkYXRpb25TZXJ2aWNlLmlzRm9ybUhvb2sodXBkYXRlT24pID8gdXBkYXRlT24gOiBcImNoYW5nZVwiXG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICBjcmVhdGVGb3JtQXJyYXkoZm9ybUFycmF5TW9kZWw6IER5bmFtaWNGb3JtQXJyYXlNb2RlbCk6IEZvcm1BcnJheSB7XG5cbiAgICAgICAgbGV0IGNvbnRyb2xzOiBBYnN0cmFjdENvbnRyb2xbXSA9IFtdLFxuICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMuY3JlYXRlQWJzdHJhY3RDb250cm9sT3B0aW9ucyhmb3JtQXJyYXlNb2RlbC52YWxpZGF0b3JzLCBmb3JtQXJyYXlNb2RlbC5hc3luY1ZhbGlkYXRvcnMsXG4gICAgICAgICAgICAgICAgZm9ybUFycmF5TW9kZWwudXBkYXRlT24pO1xuXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBmb3JtQXJyYXlNb2RlbC5zaXplOyBpbmRleCsrKSB7XG5cbiAgICAgICAgICAgIGxldCBncm91cE1vZGVsID0gZm9ybUFycmF5TW9kZWwuZ2V0KGluZGV4KSxcbiAgICAgICAgICAgICAgICBncm91cE9wdGlvbnMgPSB0aGlzLmNyZWF0ZUFic3RyYWN0Q29udHJvbE9wdGlvbnMoZm9ybUFycmF5TW9kZWwuZ3JvdXBWYWxpZGF0b3JzLFxuICAgICAgICAgICAgICAgICAgICBmb3JtQXJyYXlNb2RlbC5ncm91cEFzeW5jVmFsaWRhdG9ycywgZm9ybUFycmF5TW9kZWwudXBkYXRlT24pO1xuXG4gICAgICAgICAgICBjb250cm9scy5wdXNoKHRoaXMuY3JlYXRlRm9ybUdyb3VwKGdyb3VwTW9kZWwuZ3JvdXAsIGdyb3VwT3B0aW9ucywgZ3JvdXBNb2RlbCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBGb3JtQXJyYXkoY29udHJvbHMsIG9wdGlvbnMpO1xuICAgIH1cblxuXG4gICAgY3JlYXRlRm9ybUdyb3VwKGZvcm1Nb2RlbDogRHluYW1pY0Zvcm1Nb2RlbCwgb3B0aW9uczogQWJzdHJhY3RDb250cm9sT3B0aW9ucyB8IG51bGwgPSBudWxsLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IER5bmFtaWNQYXRoYWJsZSB8IG51bGwgPSBudWxsKTogRm9ybUdyb3VwIHtcblxuICAgICAgICBsZXQgY29udHJvbHM6IHsgW2NvbnRyb2xJZDogc3RyaW5nXTogQWJzdHJhY3RDb250cm9sOyB9ID0ge307XG5cbiAgICAgICAgZm9ybU1vZGVsLmZvckVhY2gobW9kZWwgPT4ge1xuXG4gICAgICAgICAgICBtb2RlbC5wYXJlbnQgPSBwYXJlbnQ7XG5cbiAgICAgICAgICAgIHN3aXRjaCAobW9kZWwudHlwZSkge1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0FSUkFZOlxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzW21vZGVsLmlkXSA9IHRoaXMuY3JlYXRlRm9ybUFycmF5KG1vZGVsIGFzIER5bmFtaWNGb3JtQXJyYXlNb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0dST1VQOlxuICAgICAgICAgICAgICAgIGNhc2UgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9DSEVDS0JPWF9HUk9VUDpcblxuICAgICAgICAgICAgICAgICAgICBsZXQgZ3JvdXBNb2RlbCA9IG1vZGVsIGFzIER5bmFtaWNGb3JtR3JvdXBNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwT3B0aW9ucyA9IHRoaXMuY3JlYXRlQWJzdHJhY3RDb250cm9sT3B0aW9ucyhncm91cE1vZGVsLnZhbGlkYXRvcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBNb2RlbC5hc3luY1ZhbGlkYXRvcnMsIGdyb3VwTW9kZWwudXBkYXRlT24pO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzW21vZGVsLmlkXSA9IHRoaXMuY3JlYXRlRm9ybUdyb3VwKGdyb3VwTW9kZWwuZ3JvdXAsIGdyb3VwT3B0aW9ucywgZ3JvdXBNb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcblxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udHJvbE1vZGVsID0gbW9kZWwgYXMgRHluYW1pY0Zvcm1WYWx1ZUNvbnRyb2xNb2RlbDxhbnk+LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbFN0YXRlID0ge3ZhbHVlOiBjb250cm9sTW9kZWwudmFsdWUsIGRpc2FibGVkOiBjb250cm9sTW9kZWwuZGlzYWJsZWR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbE9wdGlvbnMgPSB0aGlzLmNyZWF0ZUFic3RyYWN0Q29udHJvbE9wdGlvbnMoY29udHJvbE1vZGVsLnZhbGlkYXRvcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbE1vZGVsLmFzeW5jVmFsaWRhdG9ycywgY29udHJvbE1vZGVsLnVwZGF0ZU9uKTtcblxuICAgICAgICAgICAgICAgICAgICBjb250cm9sc1ttb2RlbC5pZF0gPSBuZXcgRm9ybUNvbnRyb2woY29udHJvbFN0YXRlLCBjb250cm9sT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBuZXcgRm9ybUdyb3VwKGNvbnRyb2xzLCBvcHRpb25zKTtcbiAgICB9XG5cblxuICAgIGdldFBhdGhTZWdtZW50KG1vZGVsOiBEeW5hbWljUGF0aGFibGUpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gbW9kZWwgaW5zdGFuY2VvZiBEeW5hbWljRm9ybUFycmF5R3JvdXBNb2RlbCA/IG1vZGVsLmluZGV4LnRvU3RyaW5nKCkgOiAobW9kZWwgYXMgRHluYW1pY0Zvcm1Db250cm9sTW9kZWwpLmlkO1xuICAgIH1cblxuXG4gICAgZ2V0UGF0aChtb2RlbDogRHluYW1pY1BhdGhhYmxlLCBqb2luOiBib29sZWFuID0gZmFsc2UpOiBzdHJpbmdbXSB8IHN0cmluZyB7XG5cbiAgICAgICAgbGV0IHBhdGggPSBbdGhpcy5nZXRQYXRoU2VnbWVudChtb2RlbCldLFxuICAgICAgICAgICAgcGFyZW50ID0gbW9kZWwucGFyZW50O1xuXG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcblxuICAgICAgICAgICAgcGF0aC51bnNoaWZ0KHRoaXMuZ2V0UGF0aFNlZ21lbnQocGFyZW50KSk7XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGpvaW4gPyBwYXRoLmpvaW4oXCIuXCIpIDogcGF0aDtcbiAgICB9XG5cblxuICAgIGFkZEZvcm1Hcm91cENvbnRyb2woZm9ybUdyb3VwOiBGb3JtR3JvdXAsIGZvcm1Nb2RlbDogRHluYW1pY1VuaW9uRm9ybU1vZGVsLCAuLi5tb2RlbHM6IER5bmFtaWNGb3JtTW9kZWwpOiB2b2lkIHtcblxuICAgICAgICBpZiAoZm9ybU1vZGVsIGluc3RhbmNlb2YgRHluYW1pY0Zvcm1Hcm91cE1vZGVsKSB7XG5cbiAgICAgICAgICAgIHRoaXMuaW5zZXJ0Rm9ybUdyb3VwQ29udHJvbChmb3JtTW9kZWwuc2l6ZSgpLCBmb3JtR3JvdXAsIGZvcm1Nb2RlbCwgLi4ubW9kZWxzKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBsZXQgX2Zvcm1Nb2RlbCA9IGZvcm1Nb2RlbCBhcyBEeW5hbWljRm9ybU1vZGVsO1xuICAgICAgICAgICAgdGhpcy5pbnNlcnRGb3JtR3JvdXBDb250cm9sKF9mb3JtTW9kZWwubGVuZ3RoLCBmb3JtR3JvdXAsIF9mb3JtTW9kZWwsIC4uLm1vZGVscyk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIG1vdmVGb3JtR3JvdXBDb250cm9sKGluZGV4OiBudW1iZXIsIHN0ZXA6IG51bWJlciwgZm9ybU1vZGVsOiBEeW5hbWljVW5pb25Gb3JtTW9kZWwpOiB2b2lkIHtcblxuICAgICAgICBpZiAoZm9ybU1vZGVsIGluc3RhbmNlb2YgRHluYW1pY0Zvcm1Hcm91cE1vZGVsKSB7XG5cbiAgICAgICAgICAgIGZvcm1Nb2RlbC5tb3ZlKGluZGV4LCBzdGVwKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBsZXQgX2Zvcm1Nb2RlbCA9IGZvcm1Nb2RlbCBhcyBEeW5hbWljRm9ybU1vZGVsO1xuICAgICAgICAgICAgX2Zvcm1Nb2RlbC5zcGxpY2UoaW5kZXggKyBzdGVwLCAwLCAuLi5fZm9ybU1vZGVsLnNwbGljZShpbmRleCwgMSkpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBpbnNlcnRGb3JtR3JvdXBDb250cm9sKGluZGV4OiBudW1iZXIsIGZvcm1Hcm91cDogRm9ybUdyb3VwLCBmb3JtTW9kZWw6IER5bmFtaWNVbmlvbkZvcm1Nb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLm1vZGVsczogRHluYW1pY0Zvcm1Nb2RlbCk6IHZvaWQge1xuXG4gICAgICAgIGxldCBwYXJlbnQgPSBmb3JtTW9kZWwgaW5zdGFuY2VvZiBEeW5hbWljRm9ybUdyb3VwTW9kZWwgPyBmb3JtTW9kZWwgOiBudWxsLFxuICAgICAgICAgICAgY29udHJvbHMgPSB0aGlzLmNyZWF0ZUZvcm1Hcm91cChtb2RlbHMsIG51bGwsIHBhcmVudCkuY29udHJvbHM7XG5cbiAgICAgICAgT2JqZWN0LmtleXMoY29udHJvbHMpLmZvckVhY2goKGNvbnRyb2xOYW1lLCBpZHgpID0+IHtcblxuICAgICAgICAgICAgbGV0IGNvbnRyb2xNb2RlbCA9IG1vZGVsc1tpZHhdO1xuXG4gICAgICAgICAgICBpZiAoZm9ybU1vZGVsIGluc3RhbmNlb2YgRHluYW1pY0Zvcm1Hcm91cE1vZGVsKSB7XG4gICAgICAgICAgICAgICAgZm9ybU1vZGVsLmluc2VydChpbmRleCwgY29udHJvbE1vZGVsKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAoZm9ybU1vZGVsIGFzIER5bmFtaWNGb3JtTW9kZWwpLnNwbGljZShpbmRleCwgMCwgY29udHJvbE1vZGVsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9ybUdyb3VwLmFkZENvbnRyb2woY29udHJvbE5hbWUsIGNvbnRyb2xzW2NvbnRyb2xOYW1lXSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgcmVtb3ZlRm9ybUdyb3VwQ29udHJvbChpbmRleDogbnVtYmVyLCBmb3JtR3JvdXA6IEZvcm1Hcm91cCwgZm9ybU1vZGVsOiBEeW5hbWljVW5pb25Gb3JtTW9kZWwpOiB2b2lkIHtcblxuICAgICAgICBpZiAoZm9ybU1vZGVsIGluc3RhbmNlb2YgRHluYW1pY0Zvcm1Hcm91cE1vZGVsKSB7XG5cbiAgICAgICAgICAgIGZvcm1Hcm91cC5yZW1vdmVDb250cm9sKGZvcm1Nb2RlbC5nZXQoaW5kZXgpLmlkKTtcbiAgICAgICAgICAgIGZvcm1Nb2RlbC5yZW1vdmUoaW5kZXgpO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGZvcm1Hcm91cC5yZW1vdmVDb250cm9sKGZvcm1Nb2RlbFtpbmRleF0uaWQpO1xuICAgICAgICAgICAgKGZvcm1Nb2RlbCBhcyBEeW5hbWljRm9ybU1vZGVsKS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBhZGRGb3JtQXJyYXlHcm91cChmb3JtQXJyYXk6IEZvcm1BcnJheSwgZm9ybUFycmF5TW9kZWw6IER5bmFtaWNGb3JtQXJyYXlNb2RlbCk6IHZvaWQge1xuXG4gICAgICAgIGxldCBncm91cE1vZGVsID0gZm9ybUFycmF5TW9kZWwuYWRkR3JvdXAoKTtcblxuICAgICAgICBmb3JtQXJyYXkucHVzaCh0aGlzLmNyZWF0ZUZvcm1Hcm91cChncm91cE1vZGVsLmdyb3VwLCBudWxsLCBncm91cE1vZGVsKSk7XG4gICAgfVxuXG5cbiAgICBpbnNlcnRGb3JtQXJyYXlHcm91cChpbmRleDogbnVtYmVyLCBmb3JtQXJyYXk6IEZvcm1BcnJheSwgZm9ybUFycmF5TW9kZWw6IER5bmFtaWNGb3JtQXJyYXlNb2RlbCk6IHZvaWQge1xuXG4gICAgICAgIGxldCBncm91cE1vZGVsID0gZm9ybUFycmF5TW9kZWwuaW5zZXJ0R3JvdXAoaW5kZXgpO1xuXG4gICAgICAgIGZvcm1BcnJheS5pbnNlcnQoaW5kZXgsIHRoaXMuY3JlYXRlRm9ybUdyb3VwKGdyb3VwTW9kZWwuZ3JvdXAsIG51bGwsIGdyb3VwTW9kZWwpKTtcbiAgICB9XG5cblxuICAgIG1vdmVGb3JtQXJyYXlHcm91cChpbmRleDogbnVtYmVyLCBzdGVwOiBudW1iZXIsIGZvcm1BcnJheTogRm9ybUFycmF5LCBmb3JtQXJyYXlNb2RlbDogRHluYW1pY0Zvcm1BcnJheU1vZGVsKTogdm9pZCB7XG5cbiAgICAgICAgbGV0IG5ld0luZGV4ID0gaW5kZXggKyBzdGVwLFxuICAgICAgICAgICAgbW92ZVVwID0gc3RlcCA+PSAwO1xuXG4gICAgICAgIGlmICgoaW5kZXggPj0gMCAmJiBpbmRleCA8IGZvcm1BcnJheU1vZGVsLnNpemUpICYmIChuZXdJbmRleCA+PSAwICYmIG5ld0luZGV4IDwgZm9ybUFycmF5TW9kZWwuc2l6ZSkpIHtcblxuICAgICAgICAgICAgbGV0IG1vdmluZ0dyb3VwczogQWJzdHJhY3RDb250cm9sW10gPSBbXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IG1vdmVVcCA/IGluZGV4IDogbmV3SW5kZXg7IGkgPD0gKG1vdmVVcCA/IG5ld0luZGV4IDogaW5kZXgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtb3ZpbmdHcm91cHMucHVzaChmb3JtQXJyYXkuYXQoaSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3ZpbmdHcm91cHMuZm9yRWFjaCgoZm9ybUNvbnRyb2wsIGlkeCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgbGV0IHBvc2l0aW9uO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1vdmVVcCkge1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGlkeCA9PT0gMCA/IG5ld0luZGV4IDogaW5kZXggKyBpZHggLSAxO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpZHggPT09IG1vdmluZ0dyb3Vwcy5sZW5ndGggLSAxID8gbmV3SW5kZXggOiBuZXdJbmRleCArIGlkeCArIDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9ybUFycmF5LnNldENvbnRyb2wocG9zaXRpb24sIGZvcm1Db250cm9sKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3JtQXJyYXlNb2RlbC5tb3ZlR3JvdXAoaW5kZXgsIHN0ZXApO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGZvcm0gYXJyYXkgZ3JvdXAgY2Fubm90IGJlIG1vdmVkIGR1ZSB0byBpbmRleCBvciBuZXcgaW5kZXggYmVpbmcgb3V0IG9mIGJvdW5kc2ApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICByZW1vdmVGb3JtQXJyYXlHcm91cChpbmRleDogbnVtYmVyLCBmb3JtQXJyYXk6IEZvcm1BcnJheSwgZm9ybUFycmF5TW9kZWw6IER5bmFtaWNGb3JtQXJyYXlNb2RlbCk6IHZvaWQge1xuXG4gICAgICAgIGZvcm1BcnJheS5yZW1vdmVBdChpbmRleCk7XG4gICAgICAgIGZvcm1BcnJheU1vZGVsLnJlbW92ZUdyb3VwKGluZGV4KTtcbiAgICB9XG5cblxuICAgIGNsZWFyRm9ybUFycmF5KGZvcm1BcnJheTogRm9ybUFycmF5LCBmb3JtQXJyYXlNb2RlbDogRHluYW1pY0Zvcm1BcnJheU1vZGVsKTogdm9pZCB7XG5cbiAgICAgICAgZm9ybUFycmF5LmNsZWFyKCk7XG4gICAgICAgIGZvcm1BcnJheU1vZGVsLmNsZWFyKCk7XG4gICAgfVxuXG5cbiAgICBmaW5kQnlJZChpZDogc3RyaW5nLCBmb3JtTW9kZWw6IER5bmFtaWNGb3JtTW9kZWwpOiBEeW5hbWljRm9ybUNvbnRyb2xNb2RlbCB8IG51bGwge1xuXG4gICAgICAgIGxldCByZXN1bHQgPSBudWxsLFxuICAgICAgICAgICAgZmluZEJ5SWRGbiA9IChpZDogc3RyaW5nLCBncm91cE1vZGVsOiBEeW5hbWljRm9ybU1vZGVsKTogdm9pZCA9PiB7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjb250cm9sTW9kZWwgb2YgZ3JvdXBNb2RlbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250cm9sTW9kZWwuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBjb250cm9sTW9kZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250cm9sTW9kZWwgaW5zdGFuY2VvZiBEeW5hbWljRm9ybUdyb3VwTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRCeUlkRm4oaWQsIChjb250cm9sTW9kZWwgYXMgRHluYW1pY0Zvcm1Hcm91cE1vZGVsKS5ncm91cCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIGZpbmRCeUlkRm4oaWQsIGZvcm1Nb2RlbCk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cblxuICAgIGZpbmRNb2RlbEJ5SWQoaWQ6IHN0cmluZywgZm9ybU1vZGVsOiBEeW5hbWljRm9ybU1vZGVsKTogRHluYW1pY0Zvcm1Db250cm9sTW9kZWwgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZEJ5SWQoaWQsIGZvcm1Nb2RlbCk7XG4gICAgfVxuXG5cbiAgICBmaW5kQ29udHJvbEJ5TW9kZWwobW9kZWw6IER5bmFtaWNGb3JtQ29udHJvbE1vZGVsLCBncm91cDogRm9ybUdyb3VwKTogQWJzdHJhY3RDb250cm9sIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiBncm91cC5yb290LmdldCh0aGlzLmdldFBhdGgobW9kZWwsIHRydWUpKTtcbiAgICB9XG5cblxuICAgIGZyb21KU09OKGpzb246IHN0cmluZyB8IG9iamVjdFtdKTogRHluYW1pY0Zvcm1Nb2RlbCB8IG5ldmVyIHtcblxuICAgICAgICBsZXQgZm9ybU1vZGVsSlNPTiA9IGlzU3RyaW5nKGpzb24pID8gSlNPTi5wYXJzZShqc29uLCBwYXJzZVJldml2ZXIpIDoganNvbixcbiAgICAgICAgICAgIGZvcm1Nb2RlbDogRHluYW1pY0Zvcm1Nb2RlbCA9IFtdO1xuXG4gICAgICAgIGZvcm1Nb2RlbEpTT04uZm9yRWFjaCgobW9kZWw6IGFueSkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgbGF5b3V0ID0gbW9kZWwubGF5b3V0IHx8IG51bGw7XG5cbiAgICAgICAgICAgIHN3aXRjaCAobW9kZWwudHlwZSkge1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0FSUkFZOlxuICAgICAgICAgICAgICAgICAgICBsZXQgZm9ybUFycmF5TW9kZWwgPSBtb2RlbCBhcyBEeW5hbWljRm9ybUFycmF5TW9kZWw7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZm9ybUFycmF5TW9kZWwuZ3JvdXBzKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtQXJyYXlNb2RlbC5ncm91cHMuZm9yRWFjaCgoZ3JvdXBNb2RlbDogRHluYW1pY0Zvcm1BcnJheUdyb3VwTW9kZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cE1vZGVsLmdyb3VwID0gdGhpcy5mcm9tSlNPTihncm91cE1vZGVsLmdyb3VwKSBhcyBEeW5hbWljRm9ybU1vZGVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBmb3JtQXJyYXlNb2RlbC5ncm91cEZhY3RvcnkgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mcm9tSlNPTihmb3JtQXJyYXlNb2RlbC5ncm91cFByb3RvdHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNGb3JtQXJyYXlNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0NIRUNLQk9YOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY0NoZWNrYm94TW9kZWwobW9kZWwsIGxheW91dCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9DSEVDS0JPWF9HUk9VUDpcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuZ3JvdXAgPSB0aGlzLmZyb21KU09OKG1vZGVsLmdyb3VwKSBhcyBEeW5hbWljQ2hlY2tib3hNb2RlbFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY0NoZWNrYm94R3JvdXBNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0NPTE9SUElDS0VSOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY0NvbG9yUGlja2VyTW9kZWwobW9kZWwsIGxheW91dCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9EQVRFUElDS0VSOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY0RhdGVQaWNrZXJNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0VESVRPUjpcbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNFZGl0b3JNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX0ZJTEVfVVBMT0FEOlxuICAgICAgICAgICAgICAgICAgICBtb2RlbC52YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1Nb2RlbC5wdXNoKG5ldyBEeW5hbWljRmlsZVVwbG9hZE1vZGVsKG1vZGVsLCBsYXlvdXQpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIERZTkFNSUNfRk9STV9DT05UUk9MX1RZUEVfR1JPVVA6XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmdyb3VwID0gdGhpcy5mcm9tSlNPTihtb2RlbC5ncm91cCk7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1Nb2RlbC5wdXNoKG5ldyBEeW5hbWljRm9ybUdyb3VwTW9kZWwobW9kZWwsIGxheW91dCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9JTlBVVDpcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0TW9kZWwgPSBtb2RlbCBhcyBEeW5hbWljSW5wdXRNb2RlbDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXRNb2RlbC5tYXNrICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpbnB1dE1vZGVsLm1hc2sgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dE1vZGVsLm1hc2sgPSBtYXNrRnJvbVN0cmluZyhpbnB1dE1vZGVsLm1hc2sgYXMgc3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGZvcm1Nb2RlbC5wdXNoKG5ldyBEeW5hbWljSW5wdXRNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1JBRElPX0dST1VQOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY1JhZGlvR3JvdXBNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1JBVElORzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNSYXRpbmdNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1NFTEVDVDpcbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNTZWxlY3RNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1NMSURFUjpcbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNTbGlkZXJNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1NXSVRDSDpcbiAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGVsLnB1c2gobmV3IER5bmFtaWNTd2l0Y2hNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBEWU5BTUlDX0ZPUk1fQ09OVFJPTF9UWVBFX1RFWFRBUkVBOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY1RleHRBcmVhTW9kZWwobW9kZWwsIGxheW91dCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgRFlOQU1JQ19GT1JNX0NPTlRST0xfVFlQRV9USU1FUElDS0VSOlxuICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZWwucHVzaChuZXcgRHluYW1pY1RpbWVQaWNrZXJNb2RlbChtb2RlbCwgbGF5b3V0KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIGZvcm0gY29udHJvbCBtb2RlbCB0eXBlIGRlZmluZWQgb24gSlNPTiBvYmplY3Qgd2l0aCBpZCBcIiR7bW9kZWwuaWR9XCJgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvcm1Nb2RlbDtcbiAgICB9XG59XG4iXX0=